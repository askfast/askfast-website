define(["controllers/controllers","modals/askfast"],function(e,t){e.controller("login",["$scope","$rootScope","AskFast","Session","Storage",function(e,t,n,r,i){e.login={email:"",password:"",validation:{email:!1,password:!1},error:{state:!1,code:null},state:!1};var s=$("#login button[type=submit]");i.session.get("app")||i.session.add("app","{}");var o=angular.fromJson(i.get("login"));o&&o.remember&&(e.login.email=o.email,e.login.password=o.password,e.login.remember=o.remember),e.auth=function(){s.text("Login..").attr("disabled","disabled"),i.add("login",angular.toJson({email:e.login.email,password:e.login.password,remember:e.login.remember})),n.login(e.login).then(function(t){[400,403,404,500].indexOf(t.status)<0&&(e.login.error={state:!0,code:t.status},s.text("Login").removeAttr("disabled")),t.hasOwnProperty("X-SESSION_ID")&&(e.login.error={state:!1,code:null},r.set(t["X-SESSION_ID"]),e.login.state=!0)})}}])});